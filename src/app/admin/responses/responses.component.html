<section>
  <div class="responsesContainer">
    <ng-container *ngIf="viewAs === 'viewAsCard'">
      <app-response-card
        *ngFor="let response of responses"
        [id]="response.id"
        [response]="response"
        (view)="viewResponse(response.id)"
        (delete)="deleteResponse(response.id)"
        (cardSelect)="selectResponse(response.id)"
        [selectable]="true"
      >
      </app-response-card>
    </ng-container>
    <div class="table-container" *ngIf="viewAs === 'viewAsTable'">
      <table>
        <thead>
          <tr>
            <th style="width: 8%">S. No.</th>
            <th style="width: 22%">property Image</th>
            <th style="width: 22%">propertyType</th>
            <th style="width: 22%">Contact</th>
            <th style="width: 10%">Stage</th>
            <th style="width: 15%"></th>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let response of responses; let i = index">
            <td>{{ i + 1 }}</td>
            <td>
              <img
                [src]="
                  response.property?.photos &&
                  response.property?.photos.length > 0
                    ? response.property?.photos[0]
                    : ''
                "
                [alt]="response.property?.name"
              />
            </td>
            <td>{{ response.property?.name }}</td>

            <td>
              <div class="buttons">
                <a href="tel:{{ response.customer?.phone }}"
                  ><i class="fa-solid fa-phone"></i
                ></a>
                <button><i class="fa-solid fa-comment-sms"></i></button>
                <a href="mailto:{{ response.customer?.email }}">
                  <i class="fa-solid fa-envelope"></i>
                </a>
              </div>
            </td>
            <td>
              <button class="stage">
                {{ phases[response.phase] }}
              </button>
            </td>
            <td>
              <div class="buttons">
                <button (click)="view.emit()"><i class="fa-solid fa-eye"></i></button>
                <button style="background-color: red; color: white" (click)="delete.emit()">
                  <i class="fa-solid fa-trash"></i>
                </button>
              </div>
            </td>
          </tr>
        </tbody>
      </table>
    </div>
    <div class="uk-position-center" uk-spinner="ratio: 4" *ngIf="loading"></div>
    <img
      class="uk-position-center"
      style="width: 400px"
      src="assets/img/empty.svg"
      alt="Empty"
      *ngIf="!loading && responses.length == 0"
    />
  </div>
</section>

<button class="actionButton" (click)="addResponse()">
  <i class="ri-add-circle-fill"></i>
</button>
<section
  [@enterAnimation]
  id="assignAgentListner"
  *ngIf="selectedResponses.length > 0"
>
  <span>
    {{ selectedResponses.length }}/{{ responses.length }} responses selected
  </span>
  <form>
    <mat-form-field appearance="fill">
      <mat-label>Agent</mat-label>
      <mat-select (selectionChange)="setAgent($event)">
        <mat-option *ngFor="let agent of agents" [value]="agent.userId">
          {{ agent.displayName }}
        </mat-option>
      </mat-select>
    </mat-form-field>
    <button
      (click)="assignAgent()"
      class="secondary-btn"
      *ngIf="this.assignedAgent != ''"
    >
      <i class="fa-solid fa-user-tie"></i> Assign Agent
    </button>
  </form>
</section>
