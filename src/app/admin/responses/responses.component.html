<section
  id="responses"
  [style]="selectedResponses.length > 0 ? 'padding-bottom: 5em' : ''"
>
  <div *ngIf="!filteredResponses" uk-spinner="ratio: 3" id="loading"></div>

  <ng-container *ngIf="filteredResponses">
    <div
      *ngIf="responses.length === 0"
      id="no-responses"
      uk-toggle="target: #add-response-modal"
    >
      <i class="fa-solid fa-plus"></i>
      <p>You have not sent any responses yet. Click here to send one.</p>
    </div>

    <ng-container *ngIf="responses.length > 0">
      <div *ngIf="viewAsInput.value == 'cards'" id="cards">
        <app-response-card
          *ngFor="let response of filteredResponses; let i = index"
          [id]="response.id"
          [response]="response"
          [selectable]="true"
          [selected]="selectedResponses.includes(response.id)"
          (view)="goToResponsePage(response.id)"
          (delete)="deleteResponse(response.id)"
          (cardSelect)="toggleResponseSelection($event)"
        ></app-response-card>
      </div>
      <div *ngIf="viewAsInput.value == 'table'" id="table">
        <table>
          <thead>
            <tr>
              <th style="width: 5%"></th>
              <th style="width: 30%">Project Name</th>
              <th style="width: 30%">Customer Name</th>
              <th style="width: 20%">Status</th>
              <th style="width: 15%"></th>
            </tr>
          </thead>
          <tbody>
            <tr *ngFor="let response of filteredResponses">
              <td>
                <button
                  class="select-button"
                  (click)="toggleResponseSelection(response.id)"
                >
                  <i
                    class="fa-solid fa-circle-check"
                    [style]="
                      'color: ' +
                      (selectedResponses.includes(response.id)
                        ? '#5cb85c'
                        : '#727a81')
                    "
                  ></i>
                </button>
              </td>
              <td>{{ response.project.name }}</td>
              <td>{{ response.customer.name }}</td>
              <td>{{ response.phase }}</td>
              <td>
                <div class="buttons">
                  <button
                    (click)="goToResponsePage(response.id)"
                    uk-tooltip="title: View Response"
                  >
                    <i class="fa-solid fa-eye"></i>
                  </button>
                  <button
                    (click)="deleteResponse(response.id)"
                    uk-tooltip="title: Delete Response"
                    class="delete-btn"
                  >
                    <i class="fa-solid fa-trash"></i>
                  </button>
                </div>
              </td>
            </tr>
          </tbody>
        </table>
      </div>
    </ng-container>
  </ng-container>
  <app-fab
    *ngIf="selectedResponses.length === 0"
    icon="plus"
    title="Add New Response"
    target="#add-response-modal"
  ></app-fab>
  <div *ngIf="selectedResponses.length > 0" id="assign-agent">
    <h5>
      {{ selectedResponses.length }}/{{ responses.length }} responses selected
    </h5>
    <form>
      <select>
        <option>Mohan Chauhan</option>
        <option>Kendrick Kumar</option>
        <option>Bobby Lamar</option>
      </select>
      <button class="secondary-btn">
        <i class="fa-solid fa-user-tie"></i> Assign Agent
      </button>
    </form>
  </div>
</section>

<div id="add-response-modal" uk-modal>
  <div class="uk-modal-dialog uk-modal-body">
    <h2 class="uk-modal-title">Add New Response</h2>
    <button class="uk-modal-close-default" type="button" uk-close></button>
    <form [formGroup]="addResponseForm" (ngSubmit)="addResponseFromForm()">
      <div class="response-form-box">
        <label for="customer-input">Customer</label>
        <div class="dropdown-container">
          <button
            (click)="toggleCustomerDropdown($event)"
            class="admin-input"
            id="customer-input"
          >
            <img [src]="getCustomerImage(addResponseForm.value.customer)" />
            {{
              getCustomerName(addResponseForm.value.customer) ||
                "Select Customer"
            }}
            <i class="fa-solid fa-angle-down"></i>
          </button>
          <div *ngIf="showCustomerDropdown" class="dropdown">
            <input
              type="text"
              placeholder="Search Customer"
              (input)="searchCustomers($event)"
            />
            <ul>
              <li
                *ngFor="let customer of filteredCustomers"
                (click)="selectCustomer(customer.id)"
              >
                <img
                  [src]="customer.img || 'assets/img/circle-user-solid.svg'"
                />
                {{ customer.name }}
              </li>
            </ul>
          </div>
        </div>
      </div>
      <div class="response-form-box">
        <label for="project-input">Project</label>
        <div class="dropdown-container">
          <button
            (click)="toggleProjectDropdown($event)"
            class="admin-input"
            id="project-input"
          >
            <img [src]="getProjectImage(addResponseForm.value.project)" />
            {{
              getProjectName(addResponseForm.value.project) || "Select Project"
            }}
            <i class="fa-solid fa-angle-down"></i>
          </button>
          <div *ngIf="showProjectDropdown" class="dropdown">
            <input
              type="text"
              placeholder="Search Project"
              (input)="searchProjects($event)"
            />
            <ul>
              <li
                *ngFor="let project of filteredProjects"
                (click)="selectProject(project.id)"
              >
                <img
                  [src]="
                    project.images && project.images.length > 0
                      ? project.images[0]
                      : 'assets/img/house-chimney-solid.svg'
                  "
                />
                {{ project.name }}
              </li>
            </ul>
          </div>
        </div>
      </div>
      <app-primary-btn
        text="Add Response"
        [disabled]="!addResponseForm.valid"
      ></app-primary-btn>
    </form>
  </div>
</div>
