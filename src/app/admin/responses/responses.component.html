<section
  id="responses"
  [style]="selectedResponses.length > 0 ? 'padding-bottom: 5em' : ''"
>
  <div
    id="no-responses"
    *ngIf="!responses || responses.length === 0"
    uk-toggle="target: #add-response-modal"
  >
    <i class="fa-solid fa-plus"></i>
    <p>You have not sent any responses yet. Click here to send one.</p>
  </div>
  <ng-container *ngIf="responses && responses.length > 0">
    <div *ngIf="viewAs == 'cards'" id="cards">
      <app-property-info-card
        *ngFor="let response of filteredResponses; let i = index"
        [id]="response.id"
        [property]="response.property"
        [customer]="response.customer"
        [status]="response.phase"
        [selectable]="true"
        [selected]="selectedResponses.includes(response.id)"
        (view)="goToResponsePage(response.id)"
        (cardSelect)="toggleResponseSelection($event)"
      ></app-property-info-card>
    </div>
    <div *ngIf="viewAs == 'table'" id="table">
      <table>
        <thead>
          <tr>
            <th></th>
            <th>Property Name</th>
            <th>Customer Name</th>
            <th>Status</th>
            <th></th>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let response of filteredResponses">
            <td>
              <button
                class="select-button"
                (click)="toggleResponseSelection(response.id)"
              >
                <i
                  class="fa-solid fa-circle-check"
                  [style]="
                    'color: ' +
                    (selectedResponses.includes(response.id)
                      ? '#5cb85c'
                      : '#727a81')
                  "
                ></i>
              </button>
            </td>
            <td>{{ response.property.name }}</td>
            <td>{{ response.customer.name }}</td>
            <td>{{ response.phase }}</td>
            <td>
              <div class="buttons">
                <button
                  (click)="goToResponsePage(response.id)"
                  uk-tooltip="title: View Response"
                >
                  <i class="fa-solid fa-eye"></i>
                </button>
                <button
                  (click)="deleteResponse(response)"
                  uk-tooltip="title: Delete Response"
                  class="delete-btn"
                >
                  <i class="fa-solid fa-trash"></i>
                </button>
              </div>
            </td>
          </tr>
        </tbody>
      </table>
    </div>
  </ng-container>
  <app-fab
    *ngIf="selectedResponses.length === 0"
    icon="plus"
    title="Add New Response"
    target="#add-response-modal"
  ></app-fab>
  <div *ngIf="selectedResponses.length > 0" id="assign-agent">
    <h5>
      {{ selectedResponses.length }}/{{ responses.length }} responses selected
    </h5>
    <form>
      <select>
        <option>Mohan Chauhan</option>
        <option>Kendrick Kumar</option>
        <option>Bobby Lamar</option>
      </select>
      <button class="secondary-btn">
        <i class="fa-solid fa-user-tie"></i> Assign Agent
      </button>
    </form>
  </div>
</section>

<div id="add-response-modal" uk-modal>
  <div class="uk-modal-dialog uk-modal-body">
    <h2 class="uk-modal-title">Add New Response</h2>
    <button class="uk-modal-close-default" type="button" uk-close></button>
    <form [formGroup]="addResponseForm" (ngSubmit)="submitResponseForm()">
      <div class="response-form-box">
        <label for="customer-input">Customer</label>
        <div class="dropdown-container">
          <button
            (click)="toggleCustomerDropdown($event)"
            class="admin-input"
            id="customer-input"
          >
            <img [src]="getCustomerImage(addResponseForm.value.customer)" />
            {{
              getCustomerName(addResponseForm.value.customer) ||
                "Select Customer"
            }}
            <i class="fa-solid fa-angle-down"></i>
          </button>
          <div *ngIf="showCustomerDropdown" class="dropdown">
            <input
              type="text"
              placeholder="Search Customer"
              (input)="searchCustomers($event)"
            />
            <ul>
              <li
                *ngFor="let customer of filteredCustomers"
                (click)="selectCustomer(customer.id)"
              >
                <img
                  [src]="customer.img || 'assets/img/circle-user-solid.svg'"
                />
                {{ customer.name }}
              </li>
            </ul>
          </div>
        </div>
      </div>
      <div class="response-form-box">
        <label for="property-input">Property</label>
        <div class="dropdown-container">
          <button
            (click)="togglePropertyDropdown($event)"
            class="admin-input"
            id="property-input"
          >
            <img [src]="getPropertyImage(addResponseForm.value.property)" />
            {{
              getPropertyName(addResponseForm.value.property) ||
                "Select Property"
            }}
            <i class="fa-solid fa-angle-down"></i>
          </button>
          <div *ngIf="showPropertyDropdown" class="dropdown">
            <input
              type="text"
              placeholder="Search Property"
              (input)="searchProperties($event)"
            />
            <ul>
              <li
                *ngFor="let property of filteredProperties"
                (click)="selectProperty(property.id)"
              >
                <img
                  [src]="(property.images && property.images.length > 0) ? property.images[0] : 'assets/img/house-chimney-solid.svg'"
                />
                {{ property.name }}
              </li>
            </ul>
          </div>
        </div>
      </div>
      <app-primary-btn
        text="Add Response"
        [disabled]="!addResponseForm.valid"
      ></app-primary-btn>
    </form>
  </div>
</div>
